dataset:
  name: cifar_100
  root: ~/datasets/cifar
  train:
    split: train
  val:
    split: test
  resize: 224

training:
  train_epochs: 240
  print_interval: 20
  val_interval: 1000
  batch_size: 64
  num_workers: 16
  sync_bn: True
  pre_train: ~/djr_project/ViT-research/run/cifar100/cnn/small/cnn-embed_res_v2-ds_28-s-1029/ckpt/best.pth
  use_train: False

model:
  # cfg names
  name: cnn
  cnn_name: cnn_block
  input_proj:
    name: resnet_like_v2
    image_channels: 3
    activation: gelu
    mid_channel: 64
  conv_block:
    name: conv_sl
    bias: True
  mlp_block:
    name: mlp_cnn
    dim_feedforward: 1152
    dropout: 0.1
  down_sample_layers: [2, 8]
  # transformers info
  embed_dim: 288
  num_layers: 6
  # others
  norm:
    name: bn
  activation: gelu

plot:
  direction:
    norm: filter
    ignore: bias_bn
  coordinate:
    x_axis:
      start: -1
      end: 1
      steps: 21
    y_axis:
      start: -1
      end: 1
      steps: 21
  cfg:
    levels: 5
    vtp_cfg:
      z_err_max: -1
      z_loss_max: 1.0e+9
      normalize_loss: -1
      num_interpolate_points: -1
      show_points: True
      show_polys: True

loss:
  name: ce_loss
  weight_dict:
    cls: 1.0
